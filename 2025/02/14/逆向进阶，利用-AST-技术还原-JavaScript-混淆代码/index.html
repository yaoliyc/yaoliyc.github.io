

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="å±¹">
  <meta name="keywords" content="">
  
    <meta name="description" content="é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨ AST æŠ€æœ¯è¿˜åŸ JavaScript æ··æ·†ä»£ç  Excerptä»€ä¹ˆæ˜¯ AST ASTï¼ˆAbstract Syntax Treeï¼‰ï¼Œä¸­æ–‡æŠ½è±¡è¯­æ³•æ ‘ï¼Œç®€ç§°è¯­æ³•æ ‘ï¼ˆSyntax Treeï¼‰ï¼Œæ˜¯æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç°å½¢å¼ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ã€‚è¯­æ³•æ ‘ä¸æ˜¯æŸä¸€ç§ç¼–ç¨‹è¯­è¨€ç‹¬æœ‰çš„ï¼ŒJavaScriptã€Pythonã€Javaã€Golang ç­‰å‡ ä¹æ‰€    ä»€ä¹ˆæ˜¯ AS">
<meta property="og:type" content="article">
<meta property="og:title" content="é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨ AST æŠ€æœ¯è¿˜åŸ JavaScript æ··æ·†ä»£ç ">
<meta property="og:url" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/index.html">
<meta property="og:site_name" content="è¯»ä¹¦ç¬”è®°">
<meta property="og:description" content="é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨ AST æŠ€æœ¯è¿˜åŸ JavaScript æ··æ·†ä»£ç  Excerptä»€ä¹ˆæ˜¯ AST ASTï¼ˆAbstract Syntax Treeï¼‰ï¼Œä¸­æ–‡æŠ½è±¡è¯­æ³•æ ‘ï¼Œç®€ç§°è¯­æ³•æ ‘ï¼ˆSyntax Treeï¼‰ï¼Œæ˜¯æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç°å½¢å¼ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ã€‚è¯­æ³•æ ‘ä¸æ˜¯æŸä¸€ç§ç¼–ç¨‹è¯­è¨€ç‹¬æœ‰çš„ï¼ŒJavaScriptã€Pythonã€Javaã€Golang ç­‰å‡ ä¹æ‰€    ä»€ä¹ˆæ˜¯ AS">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101257495-776120536.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101316575-1808878179.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101336638-888901863.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101354716-611471191.gif">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101415313-1435211089.gif">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101416281-1772382765.gif">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101417081-710154171.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101419424-269858745.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101420386-1098396170.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101420590-466240592.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101420807-432415896.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101421832-1311123747.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101422299-1490782652.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101423687-1031514148.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101426333-165530584.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101426636-489998048.png">
<meta property="og:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101427003-221259515.png">
<meta property="article:published_time" content="2025-02-14T02:29:50.000Z">
<meta property="article:modified_time" content="2025-03-02T08:58:31.736Z">
<meta property="article:author" content="å±¹">
<meta property="article:tag" content="AST">
<meta property="article:tag" content="JavaScript">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://yaoliyc.github.io/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101257495-776120536.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨ AST æŠ€æœ¯è¿˜åŸ JavaScript æ··æ·†ä»£ç  - è¯»ä¹¦ç¬”è®°</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"yaoliyc.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":null,"google":{"measurement_id":"G-PT3RGBW5EN"},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-PT3RGBW5EN", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'G-PT3RGBW5EN');
        });
      }
    </script>
  

  

  

  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>è¯»ä¹¦ç¬”è®° </strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨ AST æŠ€æœ¯è¿˜åŸ JavaScript æ··æ·†ä»£ç "></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-14 10:29" pubdate>
          2025å¹´2æœˆ14æ—¥ ä¸Šåˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.9k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          58 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨ AST æŠ€æœ¯è¿˜åŸ JavaScript æ··æ·†ä»£ç </h1>
            
            
              <div class="markdown-body">
                
                <h1 id="é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨-AST-æŠ€æœ¯è¿˜åŸ-JavaScript-æ··æ·†ä»£ç "><a href="#é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨-AST-æŠ€æœ¯è¿˜åŸ-JavaScript-æ··æ·†ä»£ç " class="headerlink" title="é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨ AST æŠ€æœ¯è¿˜åŸ JavaScript æ··æ·†ä»£ç "></a>é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨ AST æŠ€æœ¯è¿˜åŸ JavaScript æ··æ·†ä»£ç </h1><blockquote>
<h2 id="Excerpt"><a href="#Excerpt" class="headerlink" title="Excerpt"></a>Excerpt</h2><p>ä»€ä¹ˆæ˜¯ AST ASTï¼ˆAbstract Syntax Treeï¼‰ï¼Œä¸­æ–‡æŠ½è±¡è¯­æ³•æ ‘ï¼Œç®€ç§°è¯­æ³•æ ‘ï¼ˆSyntax Treeï¼‰ï¼Œæ˜¯æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç°å½¢å¼ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ã€‚è¯­æ³•æ ‘ä¸æ˜¯æŸä¸€ç§ç¼–ç¨‹è¯­è¨€ç‹¬æœ‰çš„ï¼ŒJavaScriptã€Pythonã€Javaã€Golang ç­‰å‡ ä¹æ‰€</p>
</blockquote>
<hr>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101257495-776120536.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101257495-776120536.png" srcset="/img/loading.gif" lazyload></a></p>
<h2 id="ä»€ä¹ˆæ˜¯-AST"><a href="#ä»€ä¹ˆæ˜¯-AST" class="headerlink" title="ä»€ä¹ˆæ˜¯ AST#"></a>ä»€ä¹ˆæ˜¯ AST<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E4%BB%80%E4%B9%88%E6%98%AF-ast">#</a></h2><p>ASTï¼ˆAbstract Syntax Treeï¼‰ï¼Œä¸­æ–‡æŠ½è±¡è¯­æ³•æ ‘ï¼Œç®€ç§°è¯­æ³•æ ‘ï¼ˆSyntax Treeï¼‰ï¼Œæ˜¯æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç°å½¢å¼ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ã€‚è¯­æ³•æ ‘ä¸æ˜¯æŸä¸€ç§ç¼–ç¨‹è¯­è¨€ç‹¬æœ‰çš„ï¼ŒJavaScriptã€Pythonã€Javaã€Golang ç­‰å‡ ä¹æ‰€æœ‰ç¼–ç¨‹è¯­è¨€éƒ½æœ‰è¯­æ³•æ ‘ã€‚</p>
<p>å°æ—¶å€™æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªç©å…·ï¼Œæ€»å–œæ¬¢æŠŠç©å…·æ‹†è§£æˆä¸€ä¸ªä¸€ä¸ªå°é›¶ä»¶ï¼Œç„¶åæŒ‰ç…§æˆ‘ä»¬è‡ªå·±çš„æƒ³æ³•ï¼ŒæŠŠé›¶ä»¶é‡æ–°ç»„è£…èµ·æ¥ï¼Œä¸€ä¸ªæ–°ç©å…·å°±è¯ç”Ÿäº†ã€‚è€Œ JavaScript å°±åƒä¸€å°ç²¾å¦™è¿ä½œçš„æœºå™¨ï¼Œé€šè¿‡ AST è§£æï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åƒç«¥å¹´æ—¶æ‹†è§£ç©å…·ä¸€æ ·ï¼Œæ·±å…¥äº†è§£ JavaScript è¿™å°æœºå™¨çš„å„ä¸ªé›¶éƒ¨ä»¶ï¼Œç„¶åé‡æ–°æŒ‰ç…§æˆ‘ä»¬è‡ªå·±çš„æ„æ„¿æ¥ç»„è£…ã€‚</p>
<p>AST çš„ç”¨é€”å¾ˆå¹¿ï¼ŒIDE çš„è¯­æ³•é«˜äº®ã€ä»£ç æ£€æŸ¥ã€æ ¼å¼åŒ–ã€å‹ç¼©ã€è½¬è¯‘ç­‰ï¼Œéƒ½éœ€è¦å…ˆå°†ä»£ç è½¬åŒ–æˆ AST å†è¿›è¡Œåç»­çš„æ“ä½œï¼ŒES5 å’Œ ES6 è¯­æ³•å·®å¼‚ï¼Œä¸ºäº†å‘åå…¼å®¹ï¼Œåœ¨å®é™…åº”ç”¨ä¸­éœ€è¦è¿›è¡Œè¯­æ³•çš„è½¬æ¢ï¼Œä¹Ÿä¼šç”¨åˆ° ASTã€‚AST å¹¶ä¸æ˜¯ä¸ºäº†é€†å‘è€Œç”Ÿï¼Œä½†åšé€†å‘å­¦ä¼šäº† ASTï¼Œåœ¨è§£æ··æ·†æ—¶å¯ä»¥å¦‚é±¼å¾—æ°´ã€‚</p>
<p>AST æœ‰ä¸€ä¸ªåœ¨çº¿è§£æç½‘ç«™ï¼š<a target="_blank" rel="noopener" href="https://astexplorer.net/">https://astexplorer.net/</a> ï¼Œé¡¶éƒ¨å¯ä»¥é€‰æ‹©è¯­è¨€ã€ç¼–è¯‘å™¨ã€æ˜¯å¦å¼€å¯è½¬åŒ–ç­‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒåŒºåŸŸâ‘ æ˜¯æºä»£ç ï¼ŒåŒºåŸŸâ‘¡æ˜¯å¯¹åº”çš„ AST è¯­æ³•æ ‘ï¼ŒåŒºåŸŸâ‘¢æ˜¯è½¬æ¢ä»£ç ï¼Œå¯ä»¥å¯¹è¯­æ³•æ ‘è¿›è¡Œå„ç§æ“ä½œï¼ŒåŒºåŸŸâ‘£æ˜¯è½¬æ¢åç”Ÿæˆçš„æ–°ä»£ç ã€‚å›¾ä¸­åŸæ¥çš„ Unicode å­—ç¬¦ç»è¿‡æ“ä½œä¹‹åå°±å˜æˆäº†æ­£å¸¸å­—ç¬¦ã€‚</p>
<p>è¯­æ³•æ ‘æ²¡æœ‰å•ä¸€çš„æ ¼å¼ï¼Œé€‰æ‹©ä¸åŒçš„è¯­è¨€ã€ä¸åŒçš„ç¼–è¯‘å™¨ï¼Œå¾—åˆ°çš„ç»“æœä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œåœ¨ JavaScript ä¸­ï¼Œç¼–è¯‘å™¨æœ‰ Acornã€Espreeã€Esprimaã€Recastã€Uglify-JS ç­‰ï¼Œä½¿ç”¨æœ€å¤šçš„æ˜¯ Babelï¼Œåç»­çš„å­¦ä¹ ä¹Ÿæ˜¯ä»¥ Babel ä¸ºä¾‹ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101316575-1808878179.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101316575-1808878179.png" srcset="/img/loading.gif" lazyload alt="01"></a></p>
<h2 id="AST-åœ¨ç¼–è¯‘ä¸­çš„ä½ç½®"><a href="#AST-åœ¨ç¼–è¯‘ä¸­çš„ä½ç½®" class="headerlink" title="AST åœ¨ç¼–è¯‘ä¸­çš„ä½ç½®#"></a>AST åœ¨ç¼–è¯‘ä¸­çš„ä½ç½®<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#ast-%E5%9C%A8%E7%BC%96%E8%AF%91%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AE">#</a></h2><p>åœ¨ç¼–è¯‘åŸç†ä¸­ï¼Œç¼–è¯‘å™¨è½¬æ¢ä»£ç é€šå¸¸è¦ç»è¿‡ä¸‰ä¸ªæ­¥éª¤ï¼šè¯æ³•åˆ†æï¼ˆLexical Analysisï¼‰ã€è¯­æ³•åˆ†æï¼ˆSyntax Analysisï¼‰ã€ä»£ç ç”Ÿæˆï¼ˆCode Generationï¼‰ï¼Œä¸‹å›¾ç”ŸåŠ¨å±•ç¤ºäº†è¿™ä¸€è¿‡ç¨‹ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101336638-888901863.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101336638-888901863.png" srcset="/img/loading.gif" lazyload alt="02"></a></p>
<h3 id="è¯æ³•åˆ†æ"><a href="#è¯æ³•åˆ†æ" class="headerlink" title="è¯æ³•åˆ†æ#"></a>è¯æ³•åˆ†æ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90">#</a></h3><p>è¯æ³•åˆ†æé˜¶æ®µæ˜¯ç¼–è¯‘è¿‡ç¨‹çš„ç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µçš„ä»»åŠ¡æ˜¯ä»å·¦åˆ°å³ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦åœ°è¯»å…¥æºç¨‹åºï¼Œç„¶åæ ¹æ®æ„è¯è§„åˆ™è¯†åˆ«å•è¯ï¼Œç”Ÿæˆ token ç¬¦å·æµï¼Œæ¯”å¦‚ <code>isPanda(&#39;ğŸ¼&#39;)</code>ï¼Œä¼šè¢«æ‹†åˆ†æˆ <code>isPanda</code>ï¼Œ<code>(</code>ï¼Œ<code>&#39;ğŸ¼&#39;</code>ï¼Œ<code>)</code> å››éƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†éƒ½æœ‰ä¸åŒçš„å«ä¹‰ï¼Œå¯ä»¥å°†è¯æ³•åˆ†æè¿‡ç¨‹æƒ³è±¡ä¸ºä¸åŒç±»å‹æ ‡è®°çš„åˆ—è¡¨æˆ–æ•°ç»„ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101354716-611471191.gif"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101354716-611471191.gif" srcset="/img/loading.gif" lazyload alt="03"></a></p>
<h3 id="è¯­æ³•åˆ†æ"><a href="#è¯­æ³•åˆ†æ" class="headerlink" title="è¯­æ³•åˆ†æ#"></a>è¯­æ³•åˆ†æ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90">#</a></h3><p>è¯­æ³•åˆ†ææ˜¯ç¼–è¯‘è¿‡ç¨‹çš„ä¸€ä¸ªé€»è¾‘é˜¶æ®µï¼Œè¯­æ³•åˆ†æçš„ä»»åŠ¡æ˜¯åœ¨è¯æ³•åˆ†æçš„åŸºç¡€ä¸Šå°†å•è¯åºåˆ—ç»„åˆæˆå„ç±»è¯­æ³•çŸ­è¯­ï¼Œæ¯”å¦‚â€œç¨‹åºâ€ï¼Œâ€œè¯­å¥â€ï¼Œâ€œè¡¨è¾¾å¼â€ç­‰ï¼Œå‰é¢çš„ä¾‹å­ä¸­ï¼Œ<code>isPanda(&#39;ğŸ¼&#39;)</code> å°±ä¼šè¢«åˆ†æä¸ºä¸€æ¡è¡¨è¾¾è¯­å¥ <code>ExpressionStatement</code>ï¼Œ<code>isPanda()</code> å°±ä¼šè¢«åˆ†ææˆä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼ <code>CallExpression</code>ï¼Œ<code>ğŸ¼</code> å°±ä¼šè¢«åˆ†ææˆä¸€ä¸ªå˜é‡ <code>Literal</code> ç­‰ï¼Œä¼—å¤šè¯­æ³•ä¹‹é—´çš„ä¾èµ–ã€åµŒå¥—å…³ç³»ï¼Œå°±æ„æˆäº†ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œå³ AST è¯­æ³•æ ‘ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101415313-1435211089.gif"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101415313-1435211089.gif" srcset="/img/loading.gif" lazyload alt="04"></a></p>
<h3 id="ä»£ç ç”Ÿæˆ"><a href="#ä»£ç ç”Ÿæˆ" class="headerlink" title="ä»£ç ç”Ÿæˆ#"></a>ä»£ç ç”Ÿæˆ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90">#</a></h3><p>ä»£ç ç”Ÿæˆæ˜¯æœ€åä¸€æ­¥ï¼Œå°† AST è¯­æ³•æ ‘è½¬æ¢æˆå¯æ‰§è¡Œä»£ç å³å¯ï¼Œåœ¨è½¬æ¢ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ“ä½œè¯­æ³•æ ‘ï¼Œè¿›è¡Œå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šå˜é‡çš„å£°æ˜ä½ç½®ã€æ›´æ”¹å˜é‡çš„å€¼ã€åˆ é™¤æŸäº›èŠ‚ç‚¹ç­‰ï¼Œæˆ‘ä»¬å°†è¯­å¥ <code>isPanda(&#39;ğŸ¼&#39;)</code> ä¿®æ”¹ä¸ºä¸€ä¸ªå¸ƒå°”ç±»å‹çš„ <code>Literal</code>ï¼š<code>true</code>ï¼Œè¯­æ³•æ ‘å°±æœ‰å¦‚ä¸‹å˜åŒ–ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101416281-1772382765.gif"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101416281-1772382765.gif" srcset="/img/loading.gif" lazyload alt="05"></a></p>
<h2 id="Babel-ç®€ä»‹"><a href="#Babel-ç®€ä»‹" class="headerlink" title="Babel ç®€ä»‹#"></a>Babel ç®€ä»‹<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#babel-%E7%AE%80%E4%BB%8B">#</a></h2><p>Babel æ˜¯ä¸€ä¸ª JavaScript ç¼–è¯‘å™¨ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ä¸€ä¸ªè§£æåº“ï¼ŒBabel ä¸­æ–‡ç½‘ï¼š<a target="_blank" rel="noopener" href="https://www.babeljs.cn/">https://www.babeljs.cn/</a> ï¼ŒBabel è‹±æ–‡å®˜ç½‘ï¼š<a target="_blank" rel="noopener" href="https://babeljs.io/">https://babeljs.io/</a> ï¼ŒBabel å†…ç½®äº†å¾ˆå¤šåˆ†æ JavaScript ä»£ç çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Babel å°† JavaScript ä»£ç è½¬æ¢æˆ AST è¯­æ³•æ ‘ï¼Œç„¶åå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œä¹‹åï¼Œå†è½¬æ¢æˆ JavaScript ä»£ç ã€‚</p>
<p>Babel åŒ…å«çš„å„ç§åŠŸèƒ½åŒ…ã€APIã€å„æ–¹æ³•å¯é€‰å‚æ•°ç­‰ï¼Œéƒ½éå¸¸å¤šï¼Œæœ¬æ–‡ä¸ä¸€ä¸€åˆ—ä¸¾ï¼Œåœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œåº”å½“å¤šæŸ¥è¯¢å®˜æ–¹æ–‡æ¡£ï¼Œæˆ–è€…å‚è€ƒæ–‡æœ«ç»™å‡ºçš„ä¸€äº›å­¦ä¹ èµ„æ–™ã€‚Babel çš„å®‰è£…å’Œå…¶ä»– Node åŒ…ä¸€æ ·ï¼Œéœ€è¦å“ªä¸ªå®‰è£…å“ªä¸ªå³å¯ï¼Œæ¯”å¦‚ <code>npm install @babel/core @babel/parser @babel/traverse @babel/generator</code></p>
<p>åœ¨åšé€†å‘è§£æ··æ·†ä¸­ï¼Œä¸»è¦ç”¨åˆ°äº† Babel çš„ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½åŒ…ï¼Œæœ¬æ–‡ä¹Ÿä»…ä»‹ç»ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½åŒ…ï¼š</p>
<ol>
<li><code>@babel/core</code>ï¼šBabel ç¼–è¯‘å™¨æœ¬èº«ï¼Œæä¾›äº† babel çš„ç¼–è¯‘ APIï¼›</li>
<li><code>@babel/parser</code>ï¼šå°† JavaScript ä»£ç è§£ææˆ AST è¯­æ³•æ ‘ï¼›</li>
<li><code>@babel/traverse</code>ï¼šéå†ã€ä¿®æ”¹ AST è¯­æ³•æ ‘çš„å„ä¸ªèŠ‚ç‚¹ï¼›</li>
<li><code>@babel/generator</code>ï¼šå°† AST è¿˜åŸæˆ JavaScript ä»£ç ï¼›</li>
<li><code>@babel/types</code>ï¼šåˆ¤æ–­ã€éªŒè¯èŠ‚ç‚¹çš„ç±»å‹ã€æ„å»ºæ–° AST èŠ‚ç‚¹ç­‰ã€‚</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101417081-710154171.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101417081-710154171.png" srcset="/img/loading.gif" lazyload alt="06"></a></p>
<h3 id="babel-x2F-core"><a href="#babel-x2F-core" class="headerlink" title="@babel&#x2F;core#"></a>@babel&#x2F;core<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#babelcore">#</a></h3><p>Babel ç¼–è¯‘å™¨æœ¬èº«ï¼Œè¢«æ‹†åˆ†æˆäº†ä¸‰ä¸ªæ¨¡å—ï¼š<code>@babel/parser</code>ã€<code>@babel/traverse</code>ã€<code>@babel/generator</code>ï¼Œæ¯”å¦‚ä»¥ä¸‹æ–¹æ³•çš„å¯¼å…¥æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>).<span class="hljs-property">parse</span>; <span class="hljs-keyword">const</span> parse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/core&quot;</span>).<span class="hljs-property">parse</span>; <span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/traverse&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/core&quot;</span>).<span class="hljs-property">traverse</span><br></code></pre></td></tr></table></figure>

<h3 id="babel-x2F-parser"><a href="#babel-x2F-parser" class="headerlink" title="@babel&#x2F;parser#"></a>@babel&#x2F;parser<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#babelparser">#</a></h3><p><code>@babel/parser</code> å¯ä»¥å°† JavaScript ä»£ç è§£ææˆ AST è¯­æ³•æ ‘ï¼Œå…¶ä¸­ä¸»è¦æä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><code>parser.parse(code, [&#123;options&#125;])</code>ï¼šè§£æä¸€æ®µ JavaScript ä»£ç ï¼›</li>
<li><code>parser.parseExpression(code, [&#123;options&#125;])</code>ï¼šè€ƒè™‘åˆ°äº†æ€§èƒ½é—®é¢˜ï¼Œè§£æå•ä¸ª JavaScript è¡¨è¾¾å¼ã€‚</li>
</ul>
<p>éƒ¨åˆ†å¯é€‰å‚æ•° <code>options</code>ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>allowImportExportEverywhere</code></td>
<td>é»˜è®¤ <code>import</code> å’Œ <code>export</code> å£°æ˜è¯­å¥åªèƒ½å‡ºç°åœ¨ç¨‹åºçš„æœ€é¡¶å±‚ï¼Œè®¾ç½®ä¸º <code>true</code> åˆ™åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥å£°æ˜</td>
</tr>
<tr>
<td><code>allowReturnOutsideFunction</code></td>
<td>é»˜è®¤å¦‚æœåœ¨é¡¶å±‚ä¸­ä½¿ç”¨ <code>return</code> è¯­å¥ä¼šå¼•èµ·é”™è¯¯ï¼Œè®¾ç½®ä¸º <code>true</code> å°±ä¸ä¼šæŠ¥é”™</td>
</tr>
<tr>
<td><code>sourceType</code></td>
<td>é»˜è®¤ä¸º <code>script</code>ï¼Œå½“ä»£ç ä¸­å«æœ‰ <code>import</code> ã€<code>export</code> ç­‰å…³é”®å­—æ—¶ä¼šæŠ¥é”™ï¼Œéœ€è¦æŒ‡å®šä¸º <code>module</code></td>
</tr>
<tr>
<td><code>errorRecovery</code></td>
<td>é»˜è®¤å¦‚æœ babel å‘ç°ä¸€äº›ä¸æ­£å¸¸çš„ä»£ç å°±ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè®¾ç½®ä¸º <code>true</code> åˆ™ä¼šåœ¨ä¿å­˜è§£æé”™è¯¯çš„åŒæ—¶ç»§ç»­è§£æä»£ç ï¼Œé”™è¯¯çš„è®°å½•å°†è¢«ä¿å­˜åœ¨æœ€ç»ˆç”Ÿæˆçš„ AST çš„ errors å±æ€§ä¸­ï¼Œå½“ç„¶å¦‚æœé‡åˆ°ä¸¥é‡çš„é”™è¯¯ï¼Œä¾ç„¶ä¼šç»ˆæ­¢è§£æ</td>
</tr>
</tbody></table>
<p>ä¸¾ä¸ªä¾‹å­çœ‹å¾—æ¯”è¾ƒæ¸…æ¥šï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>); <span class="hljs-keyword">const</span> code = <span class="hljs-string">&quot;const a = 1;&quot;</span>; <span class="hljs-keyword">const</span> ast = parser.<span class="hljs-title function_">parse</span>(code, &#123;<span class="hljs-attr">sourceType</span>: <span class="hljs-string">&quot;module&quot;</span>&#125;) <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ast)<br></code></pre></td></tr></table></figure>

<p><code>&#123;sourceType: &quot;module&quot;&#125;</code> æ¼”ç¤ºäº†å¦‚ä½•æ·»åŠ å¯é€‰å‚æ•°ï¼Œè¾“å‡ºçš„å°±æ˜¯ AST è¯­æ³•æ ‘ï¼Œè¿™å’Œåœ¨çº¿ç½‘ç«™ <a target="_blank" rel="noopener" href="https://astexplorer.net/">https://astexplorer.net/</a> è§£æå‡ºæ¥çš„è¯­æ³•æ ‘æ˜¯ä¸€æ ·çš„ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101419424-269858745.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101419424-269858745.png" srcset="/img/loading.gif" lazyload alt="07"></a></p>
<h3 id="babel-x2F-generator"><a href="#babel-x2F-generator" class="headerlink" title="@babel&#x2F;generator#"></a>@babel&#x2F;generator<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#babelgenerator">#</a></h3><p><code>@babel/generator</code> å¯ä»¥å°† AST è¿˜åŸæˆ JavaScript ä»£ç ï¼Œæä¾›äº†ä¸€ä¸ª <code>generate</code> æ–¹æ³•ï¼š<code>generate(ast, [&#123;options&#125;], code)</code>ã€‚</p>
<p>éƒ¨åˆ†å¯é€‰å‚æ•° <code>options</code>ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>auxiliaryCommentBefore</code></td>
<td>åœ¨è¾“å‡ºæ–‡ä»¶å†…å®¹çš„å¤´éƒ¨æ·»åŠ æ³¨é‡Šå—æ–‡å­—</td>
</tr>
<tr>
<td><code>auxiliaryCommentAfter</code></td>
<td>åœ¨è¾“å‡ºæ–‡ä»¶å†…å®¹çš„æœ«å°¾æ·»åŠ æ³¨é‡Šå—æ–‡å­—</td>
</tr>
<tr>
<td><code>comments</code></td>
<td>è¾“å‡ºå†…å®¹æ˜¯å¦åŒ…å«æ³¨é‡Š</td>
</tr>
<tr>
<td><code>compact</code></td>
<td>è¾“å‡ºå†…å®¹æ˜¯å¦ä¸æ·»åŠ ç©ºæ ¼ï¼Œé¿å…æ ¼å¼åŒ–</td>
</tr>
<tr>
<td><code>concise</code></td>
<td>è¾“å‡ºå†…å®¹æ˜¯å¦å‡å°‘ç©ºæ ¼ä½¿å…¶æ›´ç´§å‡‘ä¸€äº›</td>
</tr>
<tr>
<td><code>minified</code></td>
<td>æ˜¯å¦å‹ç¼©è¾“å‡ºä»£ç </td>
</tr>
<tr>
<td><code>retainLines</code></td>
<td>å°è¯•åœ¨è¾“å‡ºä»£ç ä¸­ä½¿ç”¨ä¸æºä»£ç ä¸­ç›¸åŒçš„è¡Œå·</td>
</tr>
</tbody></table>
<p>æ¥ç€å‰é¢çš„ä¾‹å­ï¼ŒåŸä»£ç æ˜¯ <code>const a = 1;</code>ï¼Œç°åœ¨æˆ‘ä»¬æŠŠ <code>a</code> å˜é‡ä¿®æ”¹ä¸º <code>b</code>ï¼Œå€¼ <code>1</code> ä¿®æ”¹ä¸º <code>2</code>ï¼Œç„¶åå°† AST è¿˜åŸç”Ÿæˆæ–°çš„ JS ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>); <span class="hljs-keyword">const</span> generate = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/generator&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> code = <span class="hljs-string">&quot;const a = 1;&quot;</span>; <span class="hljs-keyword">const</span> ast = parser.<span class="hljs-title function_">parse</span>(code, &#123;<span class="hljs-attr">sourceType</span>: <span class="hljs-string">&quot;module&quot;</span>&#125;) ast.<span class="hljs-property">program</span>.<span class="hljs-property">body</span>[<span class="hljs-number">0</span>].<span class="hljs-property">declarations</span>[<span class="hljs-number">0</span>].<span class="hljs-property">id</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;b&quot;</span> ast.<span class="hljs-property">program</span>.<span class="hljs-property">body</span>[<span class="hljs-number">0</span>].<span class="hljs-property">declarations</span>[<span class="hljs-number">0</span>].<span class="hljs-property">init</span>.<span class="hljs-property">value</span> = <span class="hljs-number">2</span> <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">generate</span>(ast, &#123;<span class="hljs-attr">minified</span>: <span class="hljs-literal">true</span>&#125;) <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result.<span class="hljs-property">code</span>)<br></code></pre></td></tr></table></figure>

<p>æœ€ç»ˆè¾“å‡ºçš„æ˜¯ <code>const b=2;</code>ï¼Œå˜é‡åå’Œå€¼éƒ½æˆåŠŸæ›´æ”¹äº†ï¼Œç”±äºåŠ äº†å‹ç¼©å¤„ç†ï¼Œç­‰å·å·¦å³ä¸¤è¾¹çš„ç©ºæ ¼ä¹Ÿæ²¡äº†ã€‚</p>
<p>ä»£ç é‡Œ <code>&#123;minified: true&#125;</code> æ¼”ç¤ºäº†å¦‚ä½•æ·»åŠ å¯é€‰å‚æ•°ï¼Œè¿™é‡Œè¡¨ç¤ºå‹ç¼©è¾“å‡ºä»£ç ï¼Œ<code>generate</code> å¾—åˆ°çš„ <code>result</code> å¾—åˆ°çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­çš„ <code>code</code> å±æ€§æ‰æ˜¯æœ€ç»ˆçš„ JS ä»£ç ã€‚</p>
<p>ä»£ç é‡Œ <code>ast.program.body[0].declarations[0].id.name</code> æ˜¯ a åœ¨ AST ä¸­çš„ä½ç½®ï¼Œ<code>ast.program.body[0].declarations[0].init.value</code> æ˜¯ 1 åœ¨ AST ä¸­çš„ä½ç½®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101420386-1098396170.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101420386-1098396170.png" srcset="/img/loading.gif" lazyload alt="08"></a></p>
<h3 id="babel-x2F-traverse"><a href="#babel-x2F-traverse" class="headerlink" title="@babel&#x2F;traverse#"></a>@babel&#x2F;traverse<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#babeltraverse">#</a></h3><p>å½“ä»£ç å¤šäº†ï¼Œæˆ‘ä»¬ä¸å¯èƒ½åƒå‰é¢é‚£æ ·æŒ¨ä¸ªå®šä½å¹¶ä¿®æ”¹ï¼Œå¯¹äºç›¸åŒç±»å‹çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥éå†æ‰€æœ‰èŠ‚ç‚¹æ¥è¿›è¡Œä¿®æ”¹ï¼Œè¿™é‡Œå°±ç”¨åˆ°äº† <code>@babel/traverse</code>ï¼Œå®ƒé€šå¸¸å’Œ <code>visitor</code> ä¸€èµ·ä½¿ç”¨ï¼Œ<code>visitor</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªåå­—æ˜¯å¯ä»¥éšæ„å–çš„ï¼Œ<code>visitor</code> é‡Œå¯ä»¥å®šä¹‰ä¸€äº›æ–¹æ³•æ¥è¿‡æ»¤èŠ‚ç‚¹ï¼Œè¿™é‡Œè¿˜æ˜¯ç”¨ä¸€ä¸ªä¾‹å­æ¥æ¼”ç¤ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>); <span class="hljs-keyword">const</span> generate = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/generator&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/traverse&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> code = <span class="hljs-string">` const a = 1500; const b = 60; const c = &quot;hi&quot;; const d = 787; const e = &quot;1244&quot;; `</span> <span class="hljs-keyword">const</span> ast = parser.<span class="hljs-title function_">parse</span>(code) <span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">NumericLiteral</span>(path)&#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = (path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> + <span class="hljs-number">100</span>) * <span class="hljs-number">2</span> &#125;, <span class="hljs-title class_">StringLiteral</span>(path)&#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;I Love JavaScript!&quot;</span> &#125; &#125; <span class="hljs-title function_">traverse</span>(ast, visitor) <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">generate</span>(ast) <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result.<span class="hljs-property">code</span>)<br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„åŸå§‹ä»£ç å®šä¹‰äº† abcde äº”ä¸ªå˜é‡ï¼Œå…¶å€¼æœ‰æ•°å­—ä¹Ÿæœ‰å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬åœ¨ AST ä¸­å¯ä»¥çœ‹åˆ°å¯¹åº”çš„ç±»å‹ä¸º <code>NumericLiteral</code> å’Œ <code>StringLiteral</code>ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101420590-466240592.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101420590-466240592.png" srcset="/img/loading.gif" lazyload alt="09"></a></p>
<p>ç„¶åæˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ª <code>visitor</code> å¯¹è±¡ï¼Œç„¶åå®šä¹‰å¯¹åº”ç±»å‹çš„å¤„ç†æ–¹æ³•ï¼Œ<code>traverse</code> æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ AST å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯ <code>visitor</code>ï¼Œå½“ <code>traverse</code> éå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œé‡åˆ°èŠ‚ç‚¹ç±»å‹ä¸º <code>NumericLiteral</code> å’Œ <code>StringLiteral</code> æ—¶ï¼Œå°±ä¼šè°ƒç”¨ <code>visitor</code> ä¸­å¯¹åº”çš„å¤„ç†æ–¹æ³•ï¼Œ<code>visitor</code> ä¸­çš„æ–¹æ³•ä¼šæ¥æ”¶ä¸€ä¸ªå½“å‰èŠ‚ç‚¹çš„ <code>path</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„ç±»å‹æ˜¯ <code>NodePath</code>ï¼Œè¯¥å¯¹è±¡æœ‰éå¸¸å¤šçš„å±æ€§ï¼Œä»¥ä¸‹ä»‹ç»å‡ ç§æœ€å¸¸ç”¨çš„ï¼š</p>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>toString()</code></td>
<td>å½“å‰è·¯å¾„çš„æºç </td>
</tr>
<tr>
<td><code>node</code></td>
<td>å½“å‰è·¯å¾„çš„èŠ‚ç‚¹</td>
</tr>
<tr>
<td><code>parent</code></td>
<td>å½“å‰è·¯å¾„çš„çˆ¶çº§èŠ‚ç‚¹</td>
</tr>
<tr>
<td><code>parentPath</code></td>
<td>å½“å‰è·¯å¾„çš„çˆ¶çº§è·¯å¾„</td>
</tr>
<tr>
<td><code>type</code></td>
<td>å½“å‰è·¯å¾„çš„ç±»å‹</td>
</tr>
</tbody></table>
<p>PSï¼š<code>path</code> å¯¹è±¡é™¤äº†æœ‰å¾ˆå¤šå±æ€§ä»¥å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæ¯”å¦‚æ›¿æ¢èŠ‚ç‚¹ã€åˆ é™¤èŠ‚ç‚¹ã€æ’å…¥èŠ‚ç‚¹ã€å¯»æ‰¾çˆ¶çº§èŠ‚ç‚¹ã€è·å–åŒçº§èŠ‚ç‚¹ã€æ·»åŠ æ³¨é‡Šã€åˆ¤æ–­èŠ‚ç‚¹ç±»å‹ç­‰ï¼Œå¯åœ¨éœ€è¦æ—¶æŸ¥è¯¢ç›¸å…³æ–‡æ¡£æˆ–æŸ¥çœ‹æºç ï¼Œåç»­ä»‹ç» <code>@babel/types</code> éƒ¨åˆ†å°†ä¼šä¸¾éƒ¨åˆ†ä¾‹å­æ¥æ¼”ç¤ºï¼Œä»¥åçš„å®æˆ˜æ–‡ç« ä¸­ä¹Ÿä¼šæœ‰ç›¸å…³å®ä¾‹ï¼Œç¯‡å¹…æœ‰é™æœ¬æ–‡ä¸å†ç»†è¯´ã€‚</p>
<p>å› æ­¤åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>path.node.value</code> å°±æ‹¿åˆ°äº†å˜é‡çš„å€¼ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥è¿›ä¸€æ­¥å¯¹å…¶è¿›è¡Œä¿®æ”¹äº†ã€‚ä»¥ä¸Šä»£ç è¿è¡Œåï¼Œæ‰€æœ‰æ•°å­—éƒ½ä¼šåŠ ä¸Š100åå†ä¹˜ä»¥2ï¼Œæ‰€æœ‰å­—ç¬¦ä¸²éƒ½ä¼šè¢«æ›¿æ¢æˆ <code>I Love JavaScript!</code>ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = <span class="hljs-number">3200</span>; <span class="hljs-keyword">const</span> b = <span class="hljs-number">320</span>; <span class="hljs-keyword">const</span> c = <span class="hljs-string">&quot;I Love JavaScript!&quot;</span>; <span class="hljs-keyword">const</span> d = <span class="hljs-number">1774</span>; <span class="hljs-keyword">const</span> e = <span class="hljs-string">&quot;I Love JavaScript!&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>å¦‚æœå¤šä¸ªç±»å‹çš„èŠ‚ç‚¹ï¼Œå¤„ç†çš„æ–¹å¼éƒ½ä¸€æ ·ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥ä½¿ç”¨ <code>|</code> å°†æ‰€æœ‰èŠ‚ç‚¹è¿æ¥æˆå­—ç¬¦ä¸²ï¼Œå°†åŒä¸€ä¸ªæ–¹æ³•åº”ç”¨åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-string">&quot;NumericLiteral|StringLiteral&quot;</span>(path) &#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;I Love JavaScript!&quot;</span> &#125; &#125;<br></code></pre></td></tr></table></figure>

<p><code>visitor</code> å¯¹è±¡æœ‰å¤šç§å†™æ³•ï¼Œä»¥ä¸‹å‡ ç§å†™æ³•çš„æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">NumericLiteral</span>(path)&#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = (path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> + <span class="hljs-number">100</span>) * <span class="hljs-number">2</span> &#125;, <span class="hljs-title class_">StringLiteral</span>(path)&#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;I Love JavaScript!&quot;</span> &#125; &#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">NumericLiteral</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">path</span>)&#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = (path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> + <span class="hljs-number">100</span>) * <span class="hljs-number">2</span> &#125;, <span class="hljs-title class_">StringLiteral</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">path</span>)&#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;I Love JavaScript!&quot;</span> &#125; &#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">NumericLiteral</span>: &#123; <span class="hljs-title function_">enter</span>(<span class="hljs-params">path</span>) &#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = (path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> + <span class="hljs-number">100</span>) * <span class="hljs-number">2</span> &#125; &#125;, <span class="hljs-title class_">StringLiteral</span>: &#123; <span class="hljs-title function_">enter</span>(<span class="hljs-params">path</span>) &#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;I Love JavaScript!&quot;</span> &#125; &#125; &#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title function_">enter</span>(<span class="hljs-params">path</span>) &#123; <span class="hljs-keyword">if</span> (path.<span class="hljs-property">node</span>.<span class="hljs-property">type</span> === <span class="hljs-string">&quot;NumericLiteral&quot;</span>) &#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = (path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> + <span class="hljs-number">100</span>) * <span class="hljs-number">2</span> &#125; <span class="hljs-keyword">if</span> (path.<span class="hljs-property">node</span>.<span class="hljs-property">type</span> === <span class="hljs-string">&quot;StringLiteral&quot;</span>) &#123; path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&quot;I Love JavaScript!&quot;</span> &#125; &#125; &#125;<br></code></pre></td></tr></table></figure>

<p>ä»¥ä¸Šå‡ ç§å†™æ³•ä¸­æœ‰ç”¨åˆ°äº† <code>enter</code> æ–¹æ³•ï¼Œåœ¨èŠ‚ç‚¹çš„éå†è¿‡ç¨‹ä¸­ï¼Œè¿›å…¥èŠ‚ç‚¹ï¼ˆenterï¼‰ä¸é€€å‡ºï¼ˆexitï¼‰èŠ‚ç‚¹éƒ½ä¼šè®¿é—®ä¸€æ¬¡èŠ‚ç‚¹ï¼Œ<code>traverse</code> é»˜è®¤åœ¨è¿›å…¥èŠ‚ç‚¹æ—¶è¿›è¡ŒèŠ‚ç‚¹çš„å¤„ç†ï¼Œå¦‚æœè¦åœ¨é€€å‡ºèŠ‚ç‚¹æ—¶å¤„ç†ï¼Œé‚£ä¹ˆåœ¨ <code>visitor</code> ä¸­å°±å¿…é¡»å£°æ˜ <code>exit</code> æ–¹æ³•ã€‚</p>
<h3 id="babel-x2F-types"><a href="#babel-x2F-types" class="headerlink" title="@babel&#x2F;types#"></a>@babel&#x2F;types<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#babeltypes">#</a></h3><p><code>@babel/types</code> ä¸»è¦ç”¨äºæ„å»ºæ–°çš„ AST èŠ‚ç‚¹ï¼Œå‰é¢çš„ç¤ºä¾‹ä»£ç ä¸º <code>const a = 1;</code>ï¼Œå¦‚æœæƒ³è¦å¢åŠ å†…å®¹ï¼Œæ¯”å¦‚å˜æˆ <code>const a = 1; const b = a * 5 + 1;</code>ï¼Œå°±å¯ä»¥é€šè¿‡ <code>@babel/types</code> æ¥å®ç°ã€‚</p>
<p>é¦–å…ˆè§‚å¯Ÿä¸€ä¸‹ AST è¯­æ³•æ ‘ï¼ŒåŸè¯­å¥åªæœ‰ä¸€ä¸ª <code>VariableDeclaration</code> èŠ‚ç‚¹ï¼Œç°åœ¨å¢åŠ äº†ä¸€ä¸ªï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101420807-432415896.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101420807-432415896.png" srcset="/img/loading.gif" lazyload alt="10"></a></p>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯åœ¨éå†èŠ‚ç‚¹æ—¶ï¼Œéå†åˆ° <code>VariableDeclaration</code> èŠ‚ç‚¹ï¼Œå°±åœ¨å…¶åé¢å¢åŠ ä¸€ä¸ª <code>VariableDeclaration</code> èŠ‚ç‚¹ï¼Œç”Ÿæˆ <code>VariableDeclaration</code> èŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ <code>types.variableDeclaration()</code> æ–¹æ³•ï¼Œåœ¨ types ä¸­å„ç§æ–¹æ³•åç§°å’Œæˆ‘ä»¬åœ¨ AST ä¸­çœ‹åˆ°çš„æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡é¦–å­—æ¯æ˜¯å°å†™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦çŸ¥é“æ‰€æœ‰æ–¹æ³•çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½å¤§è‡´æ¨æ–­å…¶æ–¹æ³•åï¼ŒåªçŸ¥é“è¿™ä¸ªæ–¹æ³•è¿˜ä¸è¡Œï¼Œè¿˜å¾—çŸ¥é“ä¼ å…¥çš„å‚æ•°æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥æŸ¥æ–‡æ¡£ï¼Œä¸è¿‡Kå“¥è¿™é‡Œæ¨èç›´æ¥çœ‹æºç ï¼Œéå¸¸æ¸…æ™°æ˜äº†ï¼Œä»¥ Pycharm ä¸ºä¾‹ï¼ŒæŒ‰ä½ Ctrl é”®ï¼Œå†ç‚¹å‡»æ–¹æ³•åï¼Œå°±è¿›åˆ°æºç é‡Œäº†ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101421832-1311123747.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101421832-1311123747.png" srcset="/img/loading.gif" lazyload alt="11"></a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">variableDeclaration</span>(<span class="hljs-params">kind: <span class="hljs-string">&quot;var&quot;</span> | <span class="hljs-string">&quot;let&quot;</span> | <span class="hljs-string">&quot;const&quot;</span>, declarations: <span class="hljs-built_in">Array</span>&lt;BabelNodeVariableDeclarator&gt;</span>)<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°éœ€è¦ <code>kind</code> å’Œ <code>declarations</code> ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­ <code>declarations</code> æ˜¯ <code>VariableDeclarator</code> ç±»å‹çš„èŠ‚ç‚¹ç»„æˆçš„åˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå†™å‡ºä»¥ä¸‹ <code>visitor</code> éƒ¨åˆ†çš„ä»£ç ï¼Œå…¶ä¸­ <code>path.insertAfter()</code> æ˜¯åœ¨è¯¥èŠ‚ç‚¹ä¹‹åæ’å…¥æ–°èŠ‚ç‚¹çš„æ„æ€ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">VariableDeclaration</span>(path) &#123; <span class="hljs-keyword">let</span> declaration = types.<span class="hljs-title function_">variableDeclaration</span>(<span class="hljs-string">&quot;const&quot;</span>, [declarator]) path.<span class="hljs-title function_">insertAfter</span>(declaration) &#125; &#125;<br></code></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜éœ€è¦è¿›ä¸€æ­¥å®šä¹‰ <code>declarator</code>ï¼Œä¹Ÿå°±æ˜¯ <code>VariableDeclarator</code> ç±»å‹çš„èŠ‚ç‚¹ï¼ŒæŸ¥è¯¢å…¶æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">variableDeclarator</span>(<span class="hljs-params">id: BabelNodeLVal, init?: BabelNodeExpression</span>)<br></code></pre></td></tr></table></figure>

<p>è§‚å¯Ÿ ASTï¼Œid ä¸º <code>Identifier</code> å¯¹è±¡ï¼Œinit ä¸º <code>BinaryExpression</code> å¯¹è±¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101422299-1490782652.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101422299-1490782652.png" srcset="/img/loading.gif" lazyload alt="12"></a></p>
<p>å…ˆæ¥å¤„ç† idï¼Œå¯ä»¥ä½¿ç”¨ <code>types.identifier()</code> æ–¹æ³•æ¥ç”Ÿæˆï¼Œå…¶æºç ä¸º <code>function identifier(name: string)</code>ï¼Œname åœ¨è¿™é‡Œå°±æ˜¯ b äº†ï¼Œæ­¤æ—¶ <code>visitor</code> ä»£ç å°±å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">VariableDeclaration</span>(path) &#123; <span class="hljs-keyword">let</span> declarator = types.<span class="hljs-title function_">variableDeclarator</span>(types.<span class="hljs-title function_">identifier</span>(<span class="hljs-string">&quot;b&quot;</span>), init) <span class="hljs-keyword">let</span> declaration = types.<span class="hljs-title function_">variableDeclaration</span>(<span class="hljs-string">&quot;const&quot;</span>, [declarator]) path.<span class="hljs-title function_">insertAfter</span>(declaration) &#125; &#125;<br></code></pre></td></tr></table></figure>

<p>ç„¶åå†æ¥çœ‹ init è¯¥å¦‚ä½•å®šä¹‰ï¼Œé¦–å…ˆä»ç„¶æ˜¯çœ‹ AST ç»“æ„ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101423687-1031514148.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101423687-1031514148.png" srcset="/img/loading.gif" lazyload alt="13"></a></p>
<p>init ä¸º <code>BinaryExpression</code> å¯¹è±¡ï¼Œleft å·¦è¾¹æ˜¯ <code>BinaryExpression</code>ï¼Œright å³è¾¹æ˜¯ <code>NumericLiteral</code>ï¼Œå¯ä»¥ç”¨ <code>types.binaryExpression()</code> æ–¹æ³•æ¥ç”Ÿæˆ initï¼Œå…¶æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">binaryExpression</span>(<span class="hljs-params"> operator: <span class="hljs-string">&quot;+&quot;</span> | <span class="hljs-string">&quot;-&quot;</span> | <span class="hljs-string">&quot;/&quot;</span> | <span class="hljs-string">&quot;%&quot;</span> | <span class="hljs-string">&quot;*&quot;</span> | <span class="hljs-string">&quot;**&quot;</span> | <span class="hljs-string">&quot;&amp;&quot;</span> | <span class="hljs-string">&quot;|&quot;</span> | <span class="hljs-string">&quot;&gt;&gt;&quot;</span> | <span class="hljs-string">&quot;&gt;&gt;&gt;&quot;</span> | <span class="hljs-string">&quot;&lt;&lt;&quot;</span> | <span class="hljs-string">&quot;^&quot;</span> | <span class="hljs-string">&quot;==&quot;</span> | <span class="hljs-string">&quot;===&quot;</span> | <span class="hljs-string">&quot;!=&quot;</span> | <span class="hljs-string">&quot;!==&quot;</span> | <span class="hljs-string">&quot;in&quot;</span> | <span class="hljs-string">&quot;instanceof&quot;</span> | <span class="hljs-string">&quot;&gt;&quot;</span> | <span class="hljs-string">&quot;&lt;&quot;</span> | <span class="hljs-string">&quot;&gt;=&quot;</span> | <span class="hljs-string">&quot;&lt;=&quot;</span>, left: BabelNodeExpression | BabelNodePrivateName, right: BabelNodeExpression </span>)<br></code></pre></td></tr></table></figure>

<p>æ­¤æ—¶ <code>visitor</code> ä»£ç å°±å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">VariableDeclaration</span>(path) &#123; <span class="hljs-keyword">let</span> init = types.<span class="hljs-title function_">binaryExpression</span>(<span class="hljs-string">&quot;+&quot;</span>, left, right) <span class="hljs-keyword">let</span> declarator = types.<span class="hljs-title function_">variableDeclarator</span>(types.<span class="hljs-title function_">identifier</span>(<span class="hljs-string">&quot;b&quot;</span>), init) <span class="hljs-keyword">let</span> declaration = types.<span class="hljs-title function_">variableDeclaration</span>(<span class="hljs-string">&quot;const&quot;</span>, [declarator]) path.<span class="hljs-title function_">insertAfter</span>(declaration) &#125; &#125;<br></code></pre></td></tr></table></figure>

<p>ç„¶åç»§ç»­æ„é€  left å’Œ rightï¼Œå’Œå‰é¢çš„æ–¹æ³•ä¸€æ ·ï¼Œè§‚å¯Ÿ AST è¯­æ³•æ ‘ï¼ŒæŸ¥è¯¢å¯¹åº”æ–¹æ³•åº”è¯¥ä¼ å…¥çš„å‚æ•°ï¼Œå±‚å±‚åµŒå¥—ï¼Œç›´åˆ°æŠŠæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æ„é€ å®Œæ¯•ï¼Œæœ€ç»ˆçš„ <code>visitor</code> ä»£ç åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">VariableDeclaration</span>(path) &#123; <span class="hljs-keyword">let</span> left = types.<span class="hljs-title function_">binaryExpression</span>(<span class="hljs-string">&quot;*&quot;</span>, types.<span class="hljs-title function_">identifier</span>(<span class="hljs-string">&quot;a&quot;</span>), types.<span class="hljs-title function_">numericLiteral</span>(<span class="hljs-number">5</span>)) <span class="hljs-keyword">let</span> right = types.<span class="hljs-title function_">numericLiteral</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">let</span> init = types.<span class="hljs-title function_">binaryExpression</span>(<span class="hljs-string">&quot;+&quot;</span>, left, right) <span class="hljs-keyword">let</span> declarator = types.<span class="hljs-title function_">variableDeclarator</span>(types.<span class="hljs-title function_">identifier</span>(<span class="hljs-string">&quot;b&quot;</span>), init) <span class="hljs-keyword">let</span> declaration = types.<span class="hljs-title function_">variableDeclaration</span>(<span class="hljs-string">&quot;const&quot;</span>, [declarator]) path.<span class="hljs-title function_">insertAfter</span>(declaration) path.<span class="hljs-title function_">stop</span>() &#125; &#125;<br></code></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š<code>path.insertAfter()</code> æ’å…¥èŠ‚ç‚¹è¯­å¥åé¢åŠ äº†ä¸€å¥ <code>path.stop()</code>ï¼Œè¡¨ç¤ºæ’å…¥å®Œæˆåç«‹å³åœæ­¢éå†å½“å‰èŠ‚ç‚¹å’Œåç»­çš„å­èŠ‚ç‚¹ï¼Œæ·»åŠ çš„æ–°èŠ‚ç‚¹ä¹Ÿæ˜¯ <code>VariableDeclaration</code>ï¼Œå¦‚æœä¸åŠ åœæ­¢è¯­å¥çš„è¯ï¼Œå°±ä¼šæ— é™å¾ªç¯æ’å…¥ä¸‹å»ã€‚</p>
<p>æ’å…¥æ–°èŠ‚ç‚¹åï¼Œå†è½¬æ¢æˆ JavaScript ä»£ç ï¼Œå°±å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€è¡Œæ–°ä»£ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101426333-165530584.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101426333-165530584.png" srcset="/img/loading.gif" lazyload alt="14"></a></p>
<h2 id="å¸¸è§æ··æ·†è¿˜åŸ"><a href="#å¸¸è§æ··æ·†è¿˜åŸ" class="headerlink" title="å¸¸è§æ··æ·†è¿˜åŸ#"></a>å¸¸è§æ··æ·†è¿˜åŸ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E5%B8%B8%E8%A7%81%E6%B7%B7%E6%B7%86%E8%BF%98%E5%8E%9F">#</a></h2><p>äº†è§£äº† AST å’Œ babel åï¼Œå°±å¯ä»¥å¯¹ JavaScript æ··æ·†ä»£ç è¿›è¡Œè¿˜åŸäº†ï¼Œä»¥ä¸‹æ˜¯éƒ¨åˆ†æ ·ä¾‹ï¼Œå¸¦ä½ è¿›ä¸€æ­¥ç†Ÿæ‚‰ babel çš„å„ç§æ“ä½œã€‚</p>
<h3 id="å­—ç¬¦ä¸²è¿˜åŸ"><a href="#å­—ç¬¦ä¸²è¿˜åŸ" class="headerlink" title="å­—ç¬¦ä¸²è¿˜åŸ#"></a>å­—ç¬¦ä¸²è¿˜åŸ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%98%E5%8E%9F">#</a></h3><p>æ–‡ç« å¼€å¤´çš„å›¾ä¸­ä¸¾äº†ä¸ªä¾‹å­ï¼Œæ­£å¸¸å­—ç¬¦è¢«æ¢æˆäº† Unicode ç¼–ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>[<span class="hljs-string">&#x27;\u006c\u006f\u0067&#x27;</span>](<span class="hljs-string">&#x27;\u0048\u0065\u006c\u006c\u006f\u0020\u0077\u006f\u0072\u006c\u0064\u0021&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>è§‚å¯Ÿ AST ç»“æ„ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101426636-489998048.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101426636-489998048.png" srcset="/img/loading.gif" lazyload alt="15"></a></p>
<p>æˆ‘ä»¬å‘ç° Unicode ç¼–ç å¯¹åº”çš„æ˜¯ <code>raw</code>ï¼Œè€Œ <code>rawValue</code> å’Œ <code>value</code> éƒ½æ˜¯æ­£å¸¸çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°† <code>raw</code> æ›¿æ¢æˆ <code>rawValue</code> æˆ– <code>value</code> å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¼•å·çš„é—®é¢˜ï¼Œæœ¬æ¥æ˜¯ <code>console[&quot;log&quot;]</code>ï¼Œä½ è¿˜åŸåå˜æˆäº† <code>console[log]</code>ï¼Œè‡ªç„¶ä¼šæŠ¥é”™çš„ï¼Œé™¤äº†æ›¿æ¢å€¼ä»¥å¤–ï¼Œè¿™é‡Œç›´æ¥åˆ é™¤ extra èŠ‚ç‚¹ï¼Œæˆ–è€…åˆ é™¤ raw å€¼ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ‰€ä»¥ä»¥ä¸‹å‡ ç§å†™æ³•éƒ½å¯ä»¥è¿˜åŸä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>); <span class="hljs-keyword">const</span> generate = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/generator&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/traverse&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> code = <span class="hljs-string">`console[&#x27;\u006c\u006f\u0067&#x27;](&#x27;\u0048\u0065\u006c\u006c\u006f\u0020\u0077\u006f\u0072\u006c\u0064\u0021&#x27;)`</span> <span class="hljs-keyword">const</span> ast = parser.<span class="hljs-title function_">parse</span>(code) <span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">StringLiteral</span>(path) &#123; <span class="hljs-comment">// ä»¥ä¸‹æ–¹æ³•å‡å¯ // path.node.extra.raw = path.node.rawValue // path.node.extra.raw = &#x27;&quot;&#x27; + path.node.value + &#x27;&quot;&#x27; // delete path.node.extra delete path.node.extra.raw &#125; &#125; traverse(ast, visitor) const result = generate(ast) console.log(result.code)</span><br></code></pre></td></tr></table></figure>

<p>è¿˜åŸç»“æœï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>[<span class="hljs-string">&quot;log&quot;</span>](<span class="hljs-string">&quot;Hello world!&quot;</span>);<br></code></pre></td></tr></table></figure>

<h3 id="è¡¨è¾¾å¼è¿˜åŸ"><a href="#è¡¨è¾¾å¼è¿˜åŸ" class="headerlink" title="è¡¨è¾¾å¼è¿˜åŸ#"></a>è¡¨è¾¾å¼è¿˜åŸ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%98%E5%8E%9F">#</a></h3><p>ä¹‹å‰Kå“¥å†™è¿‡ <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/ddNNxTx66-tg55Vmzo-wJQ">JSFuck æ··æ·†çš„è¿˜åŸ</a>ï¼Œå…¶ä¸­æœ‰ä»‹ç» <code>![]</code> å¯è¡¨ç¤º falseï¼Œ<code>!![]</code> æˆ–è€… <code>!+[]</code> å¯è¡¨ç¤º trueï¼Œåœ¨ä¸€äº›æ··æ·†ä»£ç ä¸­ï¼Œç»å¸¸æœ‰è¿™äº›æ“ä½œï¼ŒæŠŠç®€å•çš„è¡¨è¾¾å¼å¤æ‚åŒ–ï¼Œå¾€å¾€éœ€è¦æ‰§è¡Œä¸€ä¸‹è¯­å¥ï¼Œæ‰èƒ½å¾—åˆ°çœŸæ­£çš„ç»“æœï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = !![]+!![]+!![]; <span class="hljs-keyword">const</span> b = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-number">12.34</span> * <span class="hljs-number">2.12</span>) <span class="hljs-keyword">const</span> c = <span class="hljs-number">10</span> &gt;&gt; <span class="hljs-number">3</span> &lt;&lt; <span class="hljs-number">1</span> <span class="hljs-keyword">const</span> d = <span class="hljs-title class_">String</span>(<span class="hljs-number">21.3</span> + <span class="hljs-number">14</span> * <span class="hljs-number">1.32</span>) <span class="hljs-keyword">const</span> e = <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&quot;1.893&quot;</span> + <span class="hljs-string">&quot;45.9088&quot;</span>) <span class="hljs-keyword">const</span> f = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-string">&quot;23.2334&quot;</span> + <span class="hljs-string">&quot;21.89112&quot;</span>) <span class="hljs-keyword">const</span> g = <span class="hljs-number">20</span> &lt; <span class="hljs-number">18</span> ? <span class="hljs-string">&#x27;æœªæˆå¹´&#x27;</span> : <span class="hljs-string">&#x27;æˆå¹´&#x27;</span><br></code></pre></td></tr></table></figure>

<p>æƒ³è¦æ‰§è¡Œè¯­å¥ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ <code>path.evaluate()</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå¯¹ path å¯¹è±¡è¿›è¡Œæ‰§è¡Œæ“ä½œï¼Œè‡ªåŠ¨è®¡ç®—å‡ºç»“æœï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­çš„ <code>confident</code> å±æ€§è¡¨ç¤ºç½®ä¿¡åº¦ï¼Œ<code>value</code> è¡¨ç¤ºè®¡ç®—ç»“æœï¼Œä½¿ç”¨ <code>types.valueToNode()</code> æ–¹æ³•åˆ›å»ºèŠ‚ç‚¹ï¼Œä½¿ç”¨ <code>path.replaceInline()</code> æ–¹æ³•å°†èŠ‚ç‚¹æ›¿æ¢æˆè®¡ç®—ç»“æœç”Ÿæˆçš„æ–°èŠ‚ç‚¹ï¼Œæ›¿æ¢æ–¹æ³•æœ‰ä¸€ä¸‹å‡ ç§ï¼š</p>
<ul>
<li><code>replaceWith</code>ï¼šç”¨ä¸€ä¸ªèŠ‚ç‚¹æ›¿æ¢å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼›</li>
<li><code>replaceWithMultiple</code>ï¼šç”¨å¤šä¸ªèŠ‚ç‚¹æ›¿æ¢å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼›</li>
<li><code>replaceWithSourceString</code>ï¼šå°†ä¼ å…¥çš„æºç å­—ç¬¦ä¸²è§£ææˆå¯¹åº” Node åå†æ›¿æ¢ï¼Œæ€§èƒ½è¾ƒå·®ï¼Œä¸å»ºè®®ä½¿ç”¨ï¼›</li>
<li><code>replaceInline</code>ï¼šç”¨ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹æ›¿æ¢å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›¸å½“äºåŒæ—¶æœ‰äº†å‰ä¸¤ä¸ªå‡½æ•°çš„åŠŸèƒ½ã€‚</li>
</ul>
<p>å¯¹åº”çš„ AST å¤„ç†ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>); <span class="hljs-keyword">const</span> generate = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/generator&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/traverse&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> types = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/types&quot;</span>) <span class="hljs-keyword">const</span> code = <span class="hljs-string">` const a = !![]+!![]+!![]; const b = Math.floor(12.34 * 2.12) const c = 10 &gt;&gt; 3 &lt;&lt; 1 const d = String(21.3 + 14 * 1.32) const e = parseInt(&quot;1.893&quot; + &quot;45.9088&quot;) const f = parseFloat(&quot;23.2334&quot; + &quot;21.89112&quot;) const g = 20 &lt; 18 ? &#x27;æœªæˆå¹´&#x27; : &#x27;æˆå¹´&#x27; `</span> <span class="hljs-keyword">const</span> ast = parser.<span class="hljs-title function_">parse</span>(code) <span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-string">&quot;BinaryExpression|CallExpression|ConditionalExpression&quot;</span>(path) &#123; <span class="hljs-keyword">const</span> &#123;confident, value&#125; = path.<span class="hljs-title function_">evaluate</span>() <span class="hljs-keyword">if</span> (confident)&#123; path.<span class="hljs-title function_">replaceInline</span>(types.<span class="hljs-title function_">valueToNode</span>(value)) &#125; &#125; &#125; <span class="hljs-title function_">traverse</span>(ast, visitor) <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">generate</span>(ast) <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result.<span class="hljs-property">code</span>)<br></code></pre></td></tr></table></figure>

<p>æœ€ç»ˆç»“æœï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = <span class="hljs-number">3</span>; <span class="hljs-keyword">const</span> b = <span class="hljs-number">26</span>; <span class="hljs-keyword">const</span> c = <span class="hljs-number">2</span>; <span class="hljs-keyword">const</span> d = <span class="hljs-string">&quot;39.78&quot;</span>; <span class="hljs-keyword">const</span> e = <span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&quot;1.89345.9088&quot;</span>); <span class="hljs-keyword">const</span> f = <span class="hljs-built_in">parseFloat</span>(<span class="hljs-string">&quot;23.233421.89112&quot;</span>); <span class="hljs-keyword">const</span> g = <span class="hljs-string">&quot;\u6210\u5E74&quot;</span>;<br></code></pre></td></tr></table></figure>

<h3 id="åˆ é™¤æœªä½¿ç”¨å˜é‡"><a href="#åˆ é™¤æœªä½¿ç”¨å˜é‡" class="headerlink" title="åˆ é™¤æœªä½¿ç”¨å˜é‡#"></a>åˆ é™¤æœªä½¿ç”¨å˜é‡<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E5%88%A0%E9%99%A4%E6%9C%AA%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F">#</a></h3><p>æœ‰æ—¶å€™ä»£ç é‡Œä¼šæœ‰ä¸€äº›å¹¶æ²¡æœ‰ä½¿ç”¨åˆ°çš„å¤šä½™å˜é‡ï¼Œåˆ é™¤è¿™äº›å¤šä½™å˜é‡æœ‰åŠ©äºæ›´åŠ é«˜æ•ˆçš„åˆ†æä»£ç ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span>; <span class="hljs-keyword">const</span> b = a * <span class="hljs-number">2</span>; <span class="hljs-keyword">const</span> c = <span class="hljs-number">2</span>; <span class="hljs-keyword">const</span> d = b + <span class="hljs-number">1</span>; <span class="hljs-keyword">const</span> e = <span class="hljs-number">3</span>; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(d)<br></code></pre></td></tr></table></figure>

<p>åˆ é™¤å¤šä½™å˜é‡ï¼Œé¦–å…ˆè¦äº†è§£ <code>NodePath</code> ä¸­çš„ <code>scope</code>ï¼Œ<code>scope</code> çš„ä½œç”¨ä¸»è¦æ˜¯æŸ¥æ‰¾æ ‡è¯†ç¬¦çš„ä½œç”¨åŸŸã€è·å–å¹¶ä¿®æ”¹æ ‡è¯†ç¬¦çš„æ‰€æœ‰å¼•ç”¨ç­‰ï¼Œåˆ é™¤æœªä½¿ç”¨å˜é‡ä¸»è¦ç”¨åˆ°äº† <code>scope.getBinding()</code> æ–¹æ³•ï¼Œä¼ å…¥çš„å€¼æ˜¯å½“å‰èŠ‚ç‚¹èƒ½å¤Ÿå¼•ç”¨åˆ°çš„æ ‡è¯†ç¬¦åç§°ï¼Œè¿”å›çš„å…³é”®å±æ€§æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ul>
<li><code>identifier</code>ï¼šæ ‡è¯†ç¬¦çš„ Node å¯¹è±¡ï¼›</li>
<li><code>path</code>ï¼šæ ‡è¯†ç¬¦çš„ NodePath å¯¹è±¡ï¼›</li>
<li><code>constant</code>ï¼šæ ‡è¯†ç¬¦æ˜¯å¦ä¸ºå¸¸é‡ï¼›</li>
<li><code>referenced</code>ï¼šæ ‡è¯†ç¬¦æ˜¯å¦è¢«å¼•ç”¨ï¼›</li>
<li><code>references</code>ï¼šæ ‡è¯†ç¬¦è¢«å¼•ç”¨çš„æ¬¡æ•°ï¼›</li>
<li><code>constantViolations</code>ï¼šå¦‚æœæ ‡è¯†ç¬¦è¢«ä¿®æ”¹ï¼Œåˆ™ä¼šå­˜æ”¾æ‰€æœ‰ä¿®æ”¹è¯¥æ ‡è¯†ç¬¦èŠ‚ç‚¹çš„ Path å¯¹è±¡ï¼›</li>
<li><code>referencePaths</code>ï¼šå¦‚æœæ ‡è¯†ç¬¦è¢«å¼•ç”¨ï¼Œåˆ™ä¼šå­˜æ”¾æ‰€æœ‰å¼•ç”¨è¯¥æ ‡è¯†ç¬¦èŠ‚ç‚¹çš„ Path å¯¹è±¡ã€‚</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>constantViolations</code>ã€<code>referenced</code>ã€<code>references</code>ã€<code>referencePaths</code> å¤šä¸ªå‚æ•°æ¥åˆ¤æ–­å˜é‡æ˜¯å¦å¯ä»¥è¢«åˆ é™¤ï¼ŒAST å¤„ç†ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>); <span class="hljs-keyword">const</span> generate = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/generator&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/traverse&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> code = <span class="hljs-string">` const a = 1; const b = a * 2; const c = 2; const d = b + 1; const e = 3; console.log(d) `</span> <span class="hljs-keyword">const</span> ast = parser.<span class="hljs-title function_">parse</span>(code) <span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">VariableDeclarator</span>(path)&#123; <span class="hljs-keyword">const</span> binding = path.<span class="hljs-property">scope</span>.<span class="hljs-title function_">getBinding</span>(path.<span class="hljs-property">node</span>.<span class="hljs-property">id</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// å¦‚æ ‡è¯†ç¬¦è¢«ä¿®æ”¹è¿‡ï¼Œåˆ™ä¸èƒ½è¿›è¡Œåˆ é™¤åŠ¨ä½œã€‚ if (!binding || binding.constantViolations.length &gt; 0) &#123; return; &#125; // æœªè¢«å¼•ç”¨ if (!binding.referenced) &#123; path.remove(); &#125; // è¢«å¼•ç”¨æ¬¡æ•°ä¸º0 // if (binding.references === 0) &#123; // path.remove(); // &#125; // é•¿åº¦ä¸º0ï¼Œå˜é‡æ²¡æœ‰è¢«å¼•ç”¨è¿‡ // if (binding.referencePaths.length === 0) &#123; // path.remove(); // &#125; &#125; &#125; traverse(ast, visitor) const result = generate(ast) console.log(result.code)</span><br></code></pre></td></tr></table></figure>

<p>å¤„ç†åçš„ä»£ç ï¼ˆæœªä½¿ç”¨çš„ bã€cã€e å˜é‡å·²è¢«åˆ é™¤ï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span>; <span class="hljs-keyword">const</span> b = a * <span class="hljs-number">2</span>; <span class="hljs-keyword">const</span> d = b + <span class="hljs-number">1</span>; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(d);<br></code></pre></td></tr></table></figure>

<h3 id="åˆ é™¤å†—ä½™é€»è¾‘ä»£ç "><a href="#åˆ é™¤å†—ä½™é€»è¾‘ä»£ç " class="headerlink" title="åˆ é™¤å†—ä½™é€»è¾‘ä»£ç #"></a>åˆ é™¤å†—ä½™é€»è¾‘ä»£ç <a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E5%88%A0%E9%99%A4%E5%86%97%E4%BD%99%E9%80%BB%E8%BE%91%E4%BB%A3%E7%A0%81">#</a></h3><p>æœ‰æ—¶å€™ä¸ºäº†å¢åŠ é€†å‘éš¾åº¦ï¼Œä¼šæœ‰å¾ˆå¤šåµŒå¥—çš„ if-else è¯­å¥ï¼Œå¤§é‡åˆ¤æ–­ä¸ºå‡çš„å†—ä½™é€»è¾‘ä»£ç ï¼ŒåŒæ ·å¯ä»¥åˆ©ç”¨ AST å°†å…¶åˆ é™¤æ‰ï¼Œåªç•™ä¸‹åˆ¤æ–­ä¸ºçœŸçš„ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> example = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; <span class="hljs-keyword">let</span> a; <span class="hljs-keyword">if</span> (<span class="hljs-literal">false</span>) &#123; a = <span class="hljs-number">1</span>; &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-keyword">if</span> (<span class="hljs-number">1</span>) &#123; a = <span class="hljs-number">2</span>; &#125; <span class="hljs-keyword">else</span> &#123; a = <span class="hljs-number">3</span>; &#125; &#125; <span class="hljs-keyword">return</span> a; &#125;;<br></code></pre></td></tr></table></figure>

<p>è§‚å¯Ÿ ASTï¼Œåˆ¤æ–­æ¡ä»¶å¯¹åº”çš„æ˜¯ <code>test</code> èŠ‚ç‚¹ï¼Œif å¯¹åº”çš„æ˜¯ <code>consequent</code> èŠ‚ç‚¹ï¼Œelse å¯¹åº”çš„æ˜¯ <code>alternate</code> èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/other/2501174/202204/2501174-20220427101427003-221259515.png"><img src="/2025/02/14/%E9%80%86%E5%90%91%E8%BF%9B%E9%98%B6%EF%BC%8C%E5%88%A9%E7%94%A8-AST-%E6%8A%80%E6%9C%AF%E8%BF%98%E5%8E%9F-JavaScript-%E6%B7%B7%E6%B7%86%E4%BB%A3%E7%A0%81/2501174-20220427101427003-221259515.png" srcset="/img/loading.gif" lazyload alt="16"></a></p>
<p>AST å¤„ç†æ€è·¯ä»¥åŠä»£ç ï¼š</p>
<ol>
<li>ç­›é€‰å‡º <code>BooleanLiteral</code> å’Œ <code>NumericLiteral</code> èŠ‚ç‚¹ï¼Œå–å…¶å¯¹åº”çš„å€¼ï¼Œå³ <code>path.node.test.value</code>ï¼›</li>
<li>åˆ¤æ–­ <code>value</code> å€¼ä¸ºçœŸï¼Œåˆ™å°†èŠ‚ç‚¹æ›¿æ¢æˆ <code>consequent</code> èŠ‚ç‚¹ä¸‹çš„å†…å®¹ï¼Œå³ <code>path.node.consequent.body</code>ï¼›</li>
<li>åˆ¤æ–­ <code>value</code> å€¼ä¸ºå‡ï¼Œåˆ™æ›¿æ¢æˆ <code>alternate</code> èŠ‚ç‚¹ä¸‹çš„å†…å®¹ï¼Œå³ <code>path.node.alternate.body</code>ï¼›</li>
<li>æœ‰çš„ if è¯­å¥å¯èƒ½æ²¡æœ‰å†™ elseï¼Œä¹Ÿå°±æ²¡æœ‰ <code>alternate</code>ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µä¸‹åˆ¤æ–­ <code>value</code> å€¼ä¸ºå‡ï¼Œåˆ™ç›´æ¥ç§»é™¤è¯¥èŠ‚ç‚¹ï¼Œå³ <code>path.remove()</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>); <span class="hljs-keyword">const</span> generate = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/generator&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/traverse&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> types = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@babel/types&#x27;</span>); <span class="hljs-keyword">const</span> code = <span class="hljs-string">` const example = function () &#123; let a; if (false) &#123; a = 1; &#125; else &#123; if (1) &#123; a = 2; &#125; else &#123; a = 3; &#125; &#125; return a; &#125;; `</span> <span class="hljs-keyword">const</span> ast = parser.<span class="hljs-title function_">parse</span>(code) <span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title function_">enter</span>(<span class="hljs-params">path</span>) &#123; <span class="hljs-keyword">if</span> (types.<span class="hljs-title function_">isBooleanLiteral</span>(path.<span class="hljs-property">node</span>.<span class="hljs-property">test</span>) || types.<span class="hljs-title function_">isNumericLiteral</span>(path.<span class="hljs-property">node</span>.<span class="hljs-property">test</span>)) &#123; <span class="hljs-keyword">if</span> (path.<span class="hljs-property">node</span>.<span class="hljs-property">test</span>.<span class="hljs-property">value</span>) &#123; path.<span class="hljs-title function_">replaceInline</span>(path.<span class="hljs-property">node</span>.<span class="hljs-property">consequent</span>.<span class="hljs-property">body</span>); &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-keyword">if</span> (path.<span class="hljs-property">node</span>.<span class="hljs-property">alternate</span>) &#123; path.<span class="hljs-title function_">replaceInline</span>(path.<span class="hljs-property">node</span>.<span class="hljs-property">alternate</span>.<span class="hljs-property">body</span>); &#125; <span class="hljs-keyword">else</span> &#123; path.<span class="hljs-title function_">remove</span>() &#125; &#125; &#125; &#125; &#125; <span class="hljs-title function_">traverse</span>(ast, visitor) <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">generate</span>(ast) <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result.<span class="hljs-property">code</span>)<br></code></pre></td></tr></table></figure>

<p>å¤„ç†ç»“æœï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> example = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; <span class="hljs-keyword">let</span> a; a = <span class="hljs-number">2</span>; <span class="hljs-keyword">return</span> a; &#125;;<br></code></pre></td></tr></table></figure>

<h3 id="switch-case-åæ§åˆ¶æµå¹³å¦åŒ–"><a href="#switch-case-åæ§åˆ¶æµå¹³å¦åŒ–" class="headerlink" title="switch-case åæ§åˆ¶æµå¹³å¦åŒ–#"></a>switch-case åæ§åˆ¶æµå¹³å¦åŒ–<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#switch-case-%E5%8F%8D%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96">#</a></h3><p>æ§åˆ¶æµå¹³å¦åŒ–æ˜¯æ··æ·†å½“ä¸­æœ€å¸¸è§çš„ï¼Œé€šè¿‡ <code>if-else</code> æˆ–è€… <code>while-switch-case</code> è¯­å¥åˆ†è§£æ­¥éª¤ï¼Œç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> _0x34e16a = <span class="hljs-string">&#x27;3,4,0,5,1,2&#x27;</span>[<span class="hljs-string">&#x27;split&#x27;</span>](<span class="hljs-string">&#x27;,&#x27;</span>); <span class="hljs-keyword">let</span> _0x2eff02 = <span class="hljs-number">0x0</span>; <span class="hljs-keyword">while</span> (!![]) &#123; <span class="hljs-keyword">switch</span> (_0x34e16a[_0x2eff02++]) &#123; <span class="hljs-keyword">case</span><span class="hljs-string">&#x27;0&#x27;</span>: <span class="hljs-keyword">let</span> _0x38cb15 = _0x4588f1 + _0x470e97; <span class="hljs-keyword">continue</span>; <span class="hljs-keyword">case</span><span class="hljs-string">&#x27;1&#x27;</span>: <span class="hljs-keyword">let</span> _0x1e0e5e = _0x37b9f3[<span class="hljs-title function_">_0x50cee0</span>(<span class="hljs-number">0x2e0</span>, <span class="hljs-number">0x2e8</span>, <span class="hljs-number">0x2e1</span>, <span class="hljs-number">0x2e4</span>)]; <span class="hljs-keyword">continue</span>; <span class="hljs-keyword">case</span><span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-keyword">let</span> _0x35d732 = [<span class="hljs-title function_">_0x388d4b</span>(-<span class="hljs-number">0x134</span>, -<span class="hljs-number">0x134</span>, -<span class="hljs-number">0x139</span>, -<span class="hljs-number">0x138</span>)](_0x38cb15 &gt;&gt; _0x4588f1); <span class="hljs-keyword">continue</span>; <span class="hljs-keyword">case</span><span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-keyword">let</span> _0x4588f1 = <span class="hljs-number">0x1</span>; <span class="hljs-keyword">continue</span>; <span class="hljs-keyword">case</span><span class="hljs-string">&#x27;4&#x27;</span>: <span class="hljs-keyword">let</span> _0x470e97 = <span class="hljs-number">0x2</span>; <span class="hljs-keyword">continue</span>; <span class="hljs-keyword">case</span><span class="hljs-string">&#x27;5&#x27;</span>: <span class="hljs-keyword">let</span> _0x37b9f3 = <span class="hljs-number">0x5</span> || _0x38cb15; <span class="hljs-keyword">continue</span>; &#125; <span class="hljs-keyword">break</span>; &#125;<br></code></pre></td></tr></table></figure>

<p>AST è¿˜åŸæ€è·¯ï¼š</p>
<ol>
<li>è·å–æ§åˆ¶æµåŸå§‹æ•°ç»„ï¼Œå°† <code>&#39;3,4,0,5,1,2&#39;[&#39;split&#39;](&#39;,&#39;)</code> ä¹‹ç±»çš„è¯­å¥è½¬åŒ–æˆ <code>[&#39;3&#39;,&#39;4&#39;,&#39;0&#39;,&#39;5&#39;,&#39;1&#39;,&#39;2&#39;]</code> ä¹‹ç±»çš„æ•°ç»„ï¼Œå¾—åˆ°è¯¥æ•°ç»„ä¹‹åï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æŠŠ split è¯­å¥å¯¹åº”çš„èŠ‚ç‚¹åˆ é™¤æ‰ï¼Œå› ä¸ºæœ€ç»ˆä»£ç é‡Œè¿™æ¡è¯­å¥å°±æ²¡ç”¨äº†ï¼›</li>
<li>éå†ç¬¬ä¸€æ­¥å¾—åˆ°çš„æ§åˆ¶æµæ•°ç»„ï¼Œä¾æ¬¡å–å‡ºæ¯ä¸ªå€¼æ‰€å¯¹åº”çš„ case èŠ‚ç‚¹ï¼›</li>
<li>å®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œå‚¨å­˜æ¯ä¸ª case èŠ‚ç‚¹ <code>consequent</code> æ•°ç»„é‡Œé¢çš„å†…å®¹ï¼Œå¹¶åˆ é™¤ <code>continue</code> è¯­å¥å¯¹åº”çš„èŠ‚ç‚¹ï¼›</li>
<li>éå†å®Œæˆåï¼Œå°†ç¬¬ä¸‰æ­¥çš„æ•°ç»„æ›¿æ¢æ‰æ•´ä¸ª while èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ <code>WhileStatement</code>ã€‚</li>
</ol>
<p>ä¸åŒæ€è·¯ï¼Œå†™æ³•å¤šæ ·ï¼Œå¯¹äºå¦‚ä½•è·å–æ§åˆ¶æµæ•°ç»„ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹æ€è·¯ï¼š</p>
<ol>
<li>è·å–åˆ° <code>While</code> è¯­å¥èŠ‚ç‚¹ï¼Œç„¶åä½¿ç”¨ <code>path.getAllPrevSiblings()</code> æ–¹æ³•è·å–å…¶å‰é¢çš„æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹ï¼Œéå†æ¯ä¸ªå…„å¼ŸèŠ‚ç‚¹ï¼Œæ‰¾åˆ°ä¸ <code>switch()</code> é‡Œé¢æ•°ç»„çš„å˜é‡åç›¸åŒçš„èŠ‚ç‚¹ï¼Œç„¶åå†å–èŠ‚ç‚¹çš„å€¼è¿›è¡Œåç»­å¤„ç†ï¼›</li>
<li>ç›´æ¥å– <code>switch()</code> é‡Œé¢æ•°ç»„çš„å˜é‡åï¼Œç„¶åä½¿ç”¨ <code>scope.getBinding()</code> æ–¹æ³•è·å–åˆ°å®ƒç»‘å®šçš„èŠ‚ç‚¹ï¼Œç„¶åå†å–è¿™ä¸ªèŠ‚ç‚¹çš„å€¼è¿›è¡Œåç»­å¤„ç†ã€‚</li>
</ol>
<p>æ‰€ä»¥ AST å¤„ç†ä»£ç å°±æœ‰ä¸¤ç§å†™æ³•ï¼Œæ–¹æ³•ä¸€ï¼šï¼ˆcode.js å³ä¸ºå‰é¢çš„ç¤ºä¾‹ä»£ç ï¼Œä¸ºäº†æ–¹ä¾¿æ“ä½œï¼Œè¿™é‡Œä½¿ç”¨ fs ä»æ–‡ä»¶ä¸­è¯»å–ä»£ç ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>); <span class="hljs-keyword">const</span> generate = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/generator&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/traverse&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> types = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/types&quot;</span>) <span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs&quot;</span>); <span class="hljs-keyword">const</span> code = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;code.js&quot;</span>, &#123;<span class="hljs-attr">encoding</span>: <span class="hljs-string">&quot;utf-8&quot;</span>&#125;); <span class="hljs-keyword">const</span> ast = parser.<span class="hljs-title function_">parse</span>(code) <span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">WhileStatement</span>(path) &#123; <span class="hljs-comment">// switch èŠ‚ç‚¹ let switchNode = path.node.body.body[0]; // switch è¯­å¥å†…çš„æ§åˆ¶æµæ•°ç»„åï¼Œæœ¬ä¾‹ä¸­æ˜¯ _0x34e16a let arrayName = switchNode.discriminant.object.name; // è·å¾—æ‰€æœ‰ while å‰é¢çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œæœ¬ä¾‹ä¸­è·å–åˆ°çš„æ˜¯å£°æ˜ä¸¤ä¸ªå˜é‡çš„èŠ‚ç‚¹ï¼Œå³ const _0x34e16a å’Œ let _0x2eff02 let prevSiblings = path.getAllPrevSiblings(); // å®šä¹‰ç¼“å­˜æ§åˆ¶æµæ•°ç»„ let array = [] // forEach æ–¹æ³•éå†æ‰€æœ‰èŠ‚ç‚¹ prevSiblings.forEach(pervNode =&gt; &#123; let &#123;id, init&#125; = pervNode.node.declarations[0]; // å¦‚æœèŠ‚ç‚¹ id.name ä¸ switch è¯­å¥å†…çš„æ§åˆ¶æµæ•°ç»„åç›¸åŒ if (arrayName === id.name) &#123; // è·å–èŠ‚ç‚¹æ•´ä¸ªè¡¨è¾¾å¼çš„å‚æ•°ã€åˆ†å‰²æ–¹æ³•ã€åˆ†éš”ç¬¦ let object = init.callee.object.value; let property = init.callee.property.value; let argument = init.arguments[0].value; // æ¨¡æ‹Ÿæ‰§è¡Œ &#x27;3,4,0,5,1,2&#x27;[&#x27;split&#x27;](&#x27;,&#x27;) è¯­å¥ array = object[property](argument) // ä¹Ÿå¯ä»¥ç›´æ¥å–å‚æ•°è¿›è¡Œåˆ†å‰²ï¼Œæ–¹æ³•ä¸é€šç”¨ï¼Œæ¯”å¦‚åˆ†éš”ç¬¦æ¢æˆ | å°±ä¸è¡Œäº† // array = init.callee.object.value.split(&#x27;,&#x27;); &#125; // å‰é¢çš„å…„å¼ŸèŠ‚ç‚¹å°±å¯ä»¥åˆ é™¤äº† pervNode.remove(); &#125;); // å‚¨å­˜æ­£ç¡®é¡ºåºçš„æ§åˆ¶æµè¯­å¥ let replace = []; // éå†æ§åˆ¶æµæ•°ç»„ï¼ŒæŒ‰æ­£ç¡®é¡ºåºå– case å†…å®¹ array.forEach(index =&gt; &#123; let consequent = switchNode.cases[index].consequent; // å¦‚æœæœ€åä¸€ä¸ªèŠ‚ç‚¹æ˜¯ continue è¯­å¥ï¼Œåˆ™åˆ é™¤ ContinueStatement èŠ‚ç‚¹ if (types.isContinueStatement(consequent[consequent.length - 1])) &#123; consequent.pop(); &#125; // concat æ–¹æ³•æ‹¼æ¥å¤šä¸ªæ•°ç»„ï¼Œå³æ­£ç¡®é¡ºåºçš„ case å†…å®¹ replace = replace.concat(consequent); &#125; ); // æ›¿æ¢æ•´ä¸ª while èŠ‚ç‚¹ï¼Œä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥ path.replaceWithMultiple(replace); // path.replaceInline(replace); &#125; &#125; traverse(ast, visitor) const result = generate(ast) console.log(result.code)</span><br></code></pre></td></tr></table></figure>

<p>æ–¹æ³•äºŒï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/parser&quot;</span>); <span class="hljs-keyword">const</span> generate = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/generator&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/traverse&quot;</span>).<span class="hljs-property">default</span> <span class="hljs-keyword">const</span> types = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@babel/types&quot;</span>) <span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs&quot;</span>); <span class="hljs-keyword">const</span> code = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&quot;code.js&quot;</span>, &#123;<span class="hljs-attr">encoding</span>: <span class="hljs-string">&quot;utf-8&quot;</span>&#125;); <span class="hljs-keyword">const</span> ast = parser.<span class="hljs-title function_">parse</span>(code) <span class="hljs-keyword">const</span> visitor = &#123; <span class="hljs-title class_">WhileStatement</span>(path) &#123; <span class="hljs-comment">// switch èŠ‚ç‚¹ let switchNode = path.node.body.body[0]; // switch è¯­å¥å†…çš„æ§åˆ¶æµæ•°ç»„åï¼Œæœ¬ä¾‹ä¸­æ˜¯ _0x34e16a let arrayName = switchNode.discriminant.object.name; // è·å–æ§åˆ¶æµæ•°ç»„ç»‘å®šçš„èŠ‚ç‚¹ let bindingArray = path.scope.getBinding(arrayName); // è·å–èŠ‚ç‚¹æ•´ä¸ªè¡¨è¾¾å¼çš„å‚æ•°ã€åˆ†å‰²æ–¹æ³•ã€åˆ†éš”ç¬¦ let init = bindingArray.path.node.init; let object = init.callee.object.value; let property = init.callee.property.value; let argument = init.arguments[0].value; // æ¨¡æ‹Ÿæ‰§è¡Œ &#x27;3,4,0,5,1,2&#x27;[&#x27;split&#x27;](&#x27;,&#x27;) è¯­å¥ let array = object[property](argument) // ä¹Ÿå¯ä»¥ç›´æ¥å–å‚æ•°è¿›è¡Œåˆ†å‰²ï¼Œæ–¹æ³•ä¸é€šç”¨ï¼Œæ¯”å¦‚åˆ†éš”ç¬¦æ¢æˆ | å°±ä¸è¡Œäº† // let array = init.callee.object.value.split(&#x27;,&#x27;); // switch è¯­å¥å†…çš„æ§åˆ¶æµè‡ªå¢å˜é‡åï¼Œæœ¬ä¾‹ä¸­æ˜¯ _0x2eff02 let autoIncrementName = switchNode.discriminant.property.argument.name; // è·å–æ§åˆ¶æµè‡ªå¢å˜é‡åç»‘å®šçš„èŠ‚ç‚¹ let bindingAutoIncrement = path.scope.getBinding(autoIncrementName); // å¯é€‰æ‹©çš„æ“ä½œï¼šåˆ é™¤æ§åˆ¶æµæ•°ç»„ç»‘å®šçš„èŠ‚ç‚¹ã€è‡ªå¢å˜é‡åç»‘å®šçš„èŠ‚ç‚¹ bindingArray.path.remove(); bindingAutoIncrement.path.remove(); // å‚¨å­˜æ­£ç¡®é¡ºåºçš„æ§åˆ¶æµè¯­å¥ let replace = []; // éå†æ§åˆ¶æµæ•°ç»„ï¼ŒæŒ‰æ­£ç¡®é¡ºåºå– case å†…å®¹ array.forEach(index =&gt; &#123; let consequent = switchNode.cases[index].consequent; // å¦‚æœæœ€åä¸€ä¸ªèŠ‚ç‚¹æ˜¯ continue è¯­å¥ï¼Œåˆ™åˆ é™¤ ContinueStatement èŠ‚ç‚¹ if (types.isContinueStatement(consequent[consequent.length - 1])) &#123; consequent.pop(); &#125; // concat æ–¹æ³•æ‹¼æ¥å¤šä¸ªæ•°ç»„ï¼Œå³æ­£ç¡®é¡ºåºçš„ case å†…å®¹ replace = replace.concat(consequent); &#125; ); // æ›¿æ¢æ•´ä¸ª while èŠ‚ç‚¹ï¼Œä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥ path.replaceWithMultiple(replace); // path.replaceInline(replace); &#125; &#125; traverse(ast, visitor) const result = generate(ast) console.log(result.code)</span><br></code></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç è¿è¡Œåï¼ŒåŸæ¥çš„ <code>switch-case</code> æ§åˆ¶æµå°±è¢«è¿˜åŸäº†ï¼Œå˜æˆäº†æŒ‰é¡ºåºä¸€è¡Œä¸€è¡Œçš„ä»£ç ï¼Œæ›´åŠ ç®€æ´æ˜äº†ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> _0x4588f1 = <span class="hljs-number">0x1</span>; <span class="hljs-keyword">let</span> _0x470e97 = <span class="hljs-number">0x2</span>; <span class="hljs-keyword">let</span> _0x38cb15 = _0x4588f1 + _0x470e97; <span class="hljs-keyword">let</span> _0x37b9f3 = <span class="hljs-number">0x5</span> || _0x38cb15; <span class="hljs-keyword">let</span> _0x1e0e5e = _0x37b9f3[<span class="hljs-title function_">_0x50cee0</span>(<span class="hljs-number">0x2e0</span>, <span class="hljs-number">0x2e8</span>, <span class="hljs-number">0x2e1</span>, <span class="hljs-number">0x2e4</span>)]; <span class="hljs-keyword">let</span> _0x35d732 = [<span class="hljs-title function_">_0x388d4b</span>(-<span class="hljs-number">0x134</span>, -<span class="hljs-number">0x134</span>, -<span class="hljs-number">0x139</span>, -<span class="hljs-number">0x138</span>)](_0x38cb15 &gt;&gt; _0x4588f1);<br></code></pre></td></tr></table></figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™#"></a>å‚è€ƒèµ„æ–™<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">#</a></h2><p>æœ¬æ–‡æœ‰å‚è€ƒä»¥ä¸‹èµ„æ–™ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒæ¨èçš„åœ¨çº¿å­¦ä¹ èµ„æ–™ï¼š</p>
<ul>
<li>Youtube è§†é¢‘ï¼ŒBabel å…¥é—¨ï¼š<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=UeVq_U5obnE">https://www.youtube.com/watch?v=UeVq_U5obnE</a> ï¼ˆä½œè€… NicolÃ² Ribaudoï¼Œè§†é¢‘ä¸­çš„ PPT èµ„æ–™å¯åœ¨ K å“¥çˆ¬è™«å…¬ä¼—å·åå°å›å¤ Babel å…è´¹è·å–ï¼ï¼‰</li>
<li>å®˜æ–¹æ‰‹å†Œ Babel Handbookï¼š<a target="_blank" rel="noopener" href="https://github.com/jamiebuilds/babel-handbook">https://github.com/jamiebuilds/babel-handbook</a></li>
<li>éå®˜æ–¹ Babel API ä¸­æ–‡æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://evilrecluse.top/Babel-traverse-api-doc/">https://evilrecluse.top/Babel-traverse-api-doc/</a></li>
</ul>
<h2 id="END"><a href="#END" class="headerlink" title="END#"></a>END<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ikdl/p/16228740.html#end">#</a></h2><p>Babel ç¼–è¯‘å™¨å›½å†…çš„èµ„æ–™å…¶å®ä¸æ˜¯å¾ˆå¤šï¼Œå¤šçœ‹æºç ã€åŒæ—¶åœ¨çº¿å¯¹ç…§å¯è§†åŒ–çš„ AST è¯­æ³•æ ‘ï¼Œè€å¿ƒä¸€ç‚¹å„¿ä¸€å±‚ä¸€å±‚åˆ†æå³å¯ï¼Œæœ¬æ–‡ä¸­çš„æ¡ˆä¾‹ä¹Ÿåªæ˜¯æœ€åŸºæœ¬æ“ä½œï¼Œå®é™…é‡åˆ°ä¸€äº›æ··æ·†è¿˜å¾—è§†æƒ…å†µè¿›è¡Œä¿®æ”¹ï¼Œæ¯”å¦‚éœ€è¦åŠ ä¸€äº›ç±»å‹åˆ¤æ–­æ¥é™åˆ¶ç­‰ï¼Œåç»­Kå“¥ä¼šç”¨å®æˆ˜æ¥å¸¦é¢†å¤§å®¶è¿›ä¸€æ­¥ç†Ÿæ‚‰è§£æ··æ·†å½“ä¸­çš„å…¶ä»–æ“ä½œã€‚  </p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/AST/" class="print-no-link">#AST</a>
      
        <a href="/tags/JavaScript/" class="print-no-link">#JavaScript</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨ AST æŠ€æœ¯è¿˜åŸ JavaScript æ··æ·†ä»£ç </div>
      <div>http://yaoliyc.github.io/2025/02/14/é€†å‘è¿›é˜¶ï¼Œåˆ©ç”¨-AST-æŠ€æœ¯è¿˜åŸ-JavaScript-æ··æ·†ä»£ç /</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>å±¹</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2025å¹´2æœˆ14æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/02/21/RPC-%E6%8A%80%E6%9C%AF%E5%8F%8A%E5%85%B6%E6%A1%86%E6%9E%B6-Sekiro-%E5%9C%A8%E7%88%AC%E8%99%AB%E9%80%86%E5%90%91%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%EF%BC%8C%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE%E4%B8%80%E6%8A%8A%E6%A2%AD%EF%BC%81/" title="RPC æŠ€æœ¯åŠå…¶æ¡†æ¶ Sekiro åœ¨çˆ¬è™«é€†å‘ä¸­çš„åº”ç”¨ï¼ŒåŠ å¯†æ•°æ®ä¸€æŠŠæ¢­ï¼">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">RPC æŠ€æœ¯åŠå…¶æ¡†æ¶ Sekiro åœ¨çˆ¬è™«é€†å‘ä¸­çš„åº”ç”¨ï¼ŒåŠ å¯†æ•°æ®ä¸€æŠŠæ¢­ï¼</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/02/14/%E7%88%AC%E8%99%AB%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%EF%BC%8C%E7%90%86%E8%A7%A3-JavaScript-%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BC%96%E7%A8%8B-webpack/" title="çˆ¬è™«é€†å‘åŸºç¡€ï¼Œç†è§£ JavaScript æ¨¡å—åŒ–ç¼–ç¨‹ webpack">
                        <span class="hidden-mobile">çˆ¬è™«é€†å‘åŸºç¡€ï¼Œç†è§£ JavaScript æ¨¡å—åŒ–ç¼–ç¨‹ webpack</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="twikoo"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/twikoo/1.6.8/twikoo.all.min.js', function() {
        var options = Object.assign(
          {"envId":"https://sweet-faun-1bb615.netlify.app/.netlify/functions/twikoo","region":"ap-shanghai","path":"window.location.pathname"},
          {
            el: '#twikoo',
            path: 'window.location.pathname',
            onCommentLoaded: function() {
              Fluid.utils.listenDOMLoaded(function() {
                var imgSelector = '#twikoo .tk-content img:not(.tk-owo-emotion)';
                Fluid.plugins.imageCaption(imgSelector);
                Fluid.plugins.fancyBox(imgSelector);
              });
            }
          }
        )
        twikoo.init(options)
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="busuanzi_value_site_pv"></span>
         æ¬¡
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="busuanzi_value_site_uv"></span>
         äºº
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
